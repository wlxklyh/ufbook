# UF Book 项目迁移方案总结

## 📋 项目背景

**项目名称**：ufbook  
**项目路径**：`d:\myws\github\proj\ufbook`  
**项目目标**：为UF2025虚幻引擎嘉年华演讲整理文字总结版技术书籍

## 🎯 用户需求

1. **内容形式**：纯Markdown + 大量截图
2. **工作流要求**：
   - 直接写Markdown（无复杂配置）
   - 本地预览（bat脚本启动）
   - 简单构建（bat脚本）
   - 简单部署
3. **输出格式**：
   - 网站（HTML）
   - PDF
   - 其他电子书格式（ePub等）

## 📊 当前项目状态

### 现有技术栈
- **GitBook 3.2.3**（老版本CLI，已停止维护）
- Node.js v16.20.2
- npm 8.19.4

### 项目结构
```
ufbook/
├── animation-physics/      # 动画与物理（2篇）
├── appendix/              # 附录（3篇）
├── ecosystem/             # 引擎生态（4篇）
├── engine-features/       # 引擎功能（4篇）
├── industry/              # 行业应用（3篇）
├── mobile/                # 移动开发（2篇）
├── network/               # 网络
├── pcg/                   # 程序化生成（1篇）
├── performance/           # 性能优化（4篇）
├── project-cases/         # 项目实战（5篇）
├── rendering/             # 渲染技术（5篇）
├── scripts/               # 脚本
├── tools/                 # 开发工具（4篇）
├── book.json              # GitBook配置
├── SUMMARY.md             # 目录结构
├── README.md              # 首页
└── 各种.bat脚本
```

### 内容现状
- 已创建完整目录结构（11个技术章节）
- 约40+篇文章的目录规划
- 目前**没有图片文件**

### 已有脚本
- `start.bat`：交互式菜单
- `install.bat`：安装依赖（基本为空）
- `serve_gitbook.bat`：本地预览
- `build_gitbook.bat`：构建静态网站

### Git规则
根据workspace规则：
- ufbook项目：拉取后推送到main分支
- projrule规定：推送到main分支，不用分支

## 🔍 方案调研结果

### 评估的方案

#### ❌ 方案1：继续GitBook CLI
- **优点**：已搭建好
- **缺点**：已停止维护，兼容性差，PDF生成需额外软件
- **结论**：不推荐

#### ⚠️ 方案2：Docsify
- **优点**：最简单，无需构建，实时预览
- **缺点**：不能直接生成PDF
- **结论**：功能不够

#### ⚠️ 方案3：VitePress
- **优点**：现代化，速度快
- **缺点**：PDF支持弱，配置稍复杂
- **结论**：不是最优

#### ⚠️ 方案4：Sphinx
- **优点**：支持格式最全（HTML/PDF/ePub/LaTeX等）
- **缺点**：配置复杂，默认用reStructuredText
- **结论**：功能过于复杂

#### ✅ **最终选择：MkDocs + Pandoc**
- **MkDocs**：生成漂亮的HTML网站，本地预览
- **Pandoc**：生成多种格式（PDF/ePub/Word等）
- **优点**：
  - ✅ 都支持纯Markdown
  - ✅ MkDocs擅长做网站（Material主题漂亮）
  - ✅ Pandoc擅长做文档（支持40+格式）
  - ✅ 都有bat脚本支持
  - ✅ 图片处理出色
  - ✅ 部署简单（GitHub Pages一条命令）

## 📝 待实施方案详情

### 技术栈
- **MkDocs** + **Material主题**（网站生成）
- **Pandoc**（多格式文档生成）
- **Python 3.x**（MkDocs依赖）

### 推荐的项目结构
```
ufbook/
├── docs/                        # MkDocs内容目录
│   ├── images/                  # 统一图片目录（按章节分类）
│   │   ├── rendering/
│   │   ├── performance/
│   │   ├── engine-features/
│   │   └── ...
│   ├── rendering/               # 各章节markdown
│   │   └── article.md           # 引用: ![](../images/rendering/pic.png)
│   ├── performance/
│   ├── ... (其他章节)
│   └── index.md                 # 首页
├── mkdocs.yml                   # MkDocs配置文件
├── pandoc/                      # Pandoc配置
│   └── template.tex             # PDF模板（可选）
├── scripts/                     # 构建脚本
│   ├── install.bat              # 环境安装
│   ├── serve.bat                # 本地预览
│   ├── build-web.bat            # 构建网站
│   ├── build-pdf.bat            # 生成PDF
│   └── deploy.bat               # 部署到GitHub Pages
└── 旧GitBook文件（可删除或备份）
```

### 工作流设计

#### 日常写作
```bash
# 1. 在 docs/章节名/ 下编写markdown
# 2. 图片放在 docs/images/章节名/ 下
# 3. 引用图片：![描述](../images/章节名/图片.png)
```

#### 本地预览
```bash
双击 serve.bat
# 自动打开 http://localhost:8000
# 支持热重载，修改即生效
```

#### 构建输出
```bash
build-web.bat      # 生成HTML网站 -> site/
build-pdf.bat      # 生成PDF -> output/book.pdf
build-all.bat      # 全部生成
```

#### 部署发布
```bash
deploy.bat         # 一键部署到GitHub Pages
```

## ❓ 待确认的决策点

### 1. 迁移方式
- **选项A**：直接改造现有项目（保留所有文件，只替换构建系统）✅ **推荐**
- **选项B**：创建子目录mkdocs/，逐步迁移
- **选项C**：备份后重构

### 2. 图片目录结构
- **选项A**：统一目录按章节分类 `docs/images/章节/` ✅ **推荐**
- **选项B**：每章节独立 `docs/章节/images/`

### 3. Python环境
- 需要检查是否已安装Python
- bat脚本需包含自动检测和安装提示

### 4. 部署目标
- **GitHub Pages**（推荐，免费自动化）
- 自己的服务器
- 暂不考虑

### 5. PDF生成策略
- **单个完整PDF**（所有文章合并）✅ **推荐先做**
- 每章节单独PDF
- 两种都要

## 🚀 下一步行动计划

### Phase 1: 环境准备
1. 检查Python环境
2. 创建requirements.txt（mkdocs, mkdocs-material, pymdown-extensions）
3. 创建install.bat（自动安装依赖）

### Phase 2: 项目结构调整
1. 创建docs目录
2. 创建docs/images/目录结构（11个子目录）
3. 迁移现有markdown到docs/对应章节
4. 创建mkdocs.yml配置

### Phase 3: 脚本编写
1. serve.bat（本地预览）
2. build-web.bat（构建网站）
3. build-pdf.bat（生成PDF，需先安装Pandoc）
4. deploy.bat（GitHub Pages部署）

### Phase 4: 测试验证
1. 测试本地预览
2. 测试网站构建
3. 测试PDF生成
4. 测试部署流程

### Phase 5: 文档完善
1. 更新README.md（新的使用说明）
2. 添加图片使用规范文档
3. 清理旧的GitBook文件

## 📦 需要的软件/工具

### 必需
- **Python 3.7+**（MkDocs依赖）
- **pip**（Python包管理器）

### MkDocs相关
```bash
pip install mkdocs
pip install mkdocs-material
pip install pymdown-extensions
```

### Pandoc相关
- **Pandoc**（从官网下载安装）
- **MiKTeX 或 TeX Live**（生成PDF需要，可选）

## 💡 关键技术点

### MkDocs Material主题特性
- 深色/浅色模式切换
- 内置搜索功能
- 图片点击放大
- 代码高亮
- 响应式设计
- 导航面包屑
- 页面目录（TOC）

### Pandoc PDF生成
- 支持中文（需配置字体）
- 可自定义模板
- 支持目录生成
- 支持代码高亮
- 图片自动处理

### 图片最佳实践
- 建议格式：PNG（截图）、JPG（照片）
- 建议分辨率：1920x1080或更低
- 文件命名：英文+数字+描述（如：`ue5-rendering-pipeline-01.png`）
- 体积控制：单张<500KB为宜

## 📞 技术支持参考

- MkDocs官方文档：https://www.mkdocs.org/
- Material主题文档：https://squidfunk.github.io/mkdocs-material/
- Pandoc用户手册：https://pandoc.org/MANUAL.html

## ✅ 用户最终确认

**选择方案**：MkDocs + Pandoc  
**待执行**：实施迁移

---

**总结时间**：2026-01-07  
**下一个Agent任务**：根据本文档执行MkDocs + Pandoc方案的实施

